# Llamie Telegram Bot

Telegram –±–æ—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Ollama API. –ë–æ—Ç –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Å –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–æ–º Ollama, —Ç–∞–∫ –∏ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π —á–µ—Ä–µ–∑ Docker.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ollama –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤ (—Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –æ—Ç–≤–µ—Ç—ã)
- üß† –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–µ—Å–µ–¥—ã
- üìù –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- üîÑ –ö–æ–º–∞–Ω–¥–∞ —Å–±—Ä–æ—Å–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- üê≥ –ì–æ—Ç–æ–≤–∞—è Docker-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone <repo-url>
cd llamie
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
BOT_TOKEN=your_telegram_bot_token_here
OLLAMIE_TOKEN=your_ollama_token_here  # –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ Ollama
OLLAMA_MODEL=gpt-oss:120b
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å Docker Compose
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–±–æ—Ç + –ª–æ–∫–∞–ª—å–Ω—ã–π Ollama + –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
docker-compose up -d

# –ò–ª–∏ —Ç–æ–ª—å–∫–æ –±–æ—Ç (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–Ω–µ—à–Ω–∏–π Ollama)
docker-compose up -d llamie-bot
```

### 4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å –≤ Ollama
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É Ollama
docker exec -it llamie-ollama ollama pull gpt-oss:120b

# –ò–ª–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ http://localhost:3000
```

## –°–µ—Ä–≤–∏—Å—ã –≤ Docker Compose

- **llamie-bot** - Telegram –±–æ—Ç (–ø–æ—Ä—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- **ollama** - –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä Ollama (–ø–æ—Ä—Ç 11434)
- **ollama-webui** - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è Ollama (–ø–æ—Ä—Ç 3000)

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/reset` - –°–±—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –±–µ—Å–µ–¥—ã
- –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ `@OllamieBot` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –≤ –≥—Ä—É–ø–ø–µ
- –û—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ—Å–µ–¥—É

## –õ–æ–≥–∏

- –õ–æ–≥–∏ –±–æ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./logs/llamie_bot.log`
- –¢–∞–∫–∂–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤:
```bash
# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f llamie-bot

# –í—Å–µ –ª–æ–≥–∏
docker-compose logs llamie-bot
```

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
```bash
python bot.py
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GPU (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU —Å Ollama —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ü–∏—é –≤ `docker-compose.yml`:

```yaml
deploy:
  resources:
    reservations:
      devices:
        - driver: nvidia
          count: 1
          capabilities: [gpu]
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω NVIDIA Docker runtime.

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –û—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª–µ–Ω–∏–µ volumes)
docker-compose down -v
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | *–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ* |
| `OLLAMIE_TOKEN` | –¢–æ–∫–µ–Ω –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ Ollama | *–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ* |
| `OLLAMA_MODEL` | –ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è | `gpt-oss:120b` |
| `OLLAMA_HOST` | –•–æ—Å—Ç Ollama —Å–µ—Ä–≤–µ—Ä–∞ | `http://ollama:11434` |

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs llamie-bot`

### Ollama –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker-compose ps`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞: `docker exec -it llamie-ollama ollama list`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs ollama`

### –ü—Ä–æ–±–ª–µ–º—ã —Å GPU
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ NVIDIA Docker runtime
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä–∞–π–≤–µ—Ä—ã NVIDIA
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GPU –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ: `docker exec -it llamie-ollama nvidia-smi`
